version: '3.8'

services:
  nodeimage:
    image: jbyyy/nodeimage_clone:latest
    container_name: nodeimage
    restart: unless-stopped
    ports:
      - "7878:7878"
    environment:
      # === 核心配置 ===
      - SESSION_SECRET=gibara_change_me_to_random  # 请修改为随机字符串
      - TZ=Asia/Shanghai                           # 设置时区
      
      # === 优化版特有配置 (可选) ===
      - MAX_FILE_SIZE=104857600          # 单文件最大 100MB
      - ENABLE_AUTO_CLEANUP=true         # 启用过期图片自动清理
      - CLEANUP_EXPIRED_INTERVAL=3600000 # 清理间隔：1小时
      - DB_CACHE_FLUSH_INTERVAL=5000     # 数据库写入缓冲：5秒
      
      # === 反向代理配置 (如果有域名请启用) ===
      # - BASE_URL=https://img.example.com
      - TRUST_PROXY=true

    volumes:
      - ./uploads:/app/uploads
      - ./data:/app/data
      - ./logs:/app/logs
